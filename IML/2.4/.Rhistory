load('Weekly.rda')
View(Weekly)
plot(Weekly$Today, type='o')
plot(Weekly[Year==1990]$Today, type='o')
plot(Weekly[weekly$Year==1990]$Today, type='o')
plot(Weekly[Weekly$Year==1990]$Today, type='o')
Weekly[Weekly$Year < 1991]
Weekly$Year < 1990
Weekly$Year < 1991
Weekly[Weekly$Year < 1991, ]
plot(Weekly[Weekly$Year==1990, ]$Today, type='o')
plot(Weekly[Weekly$Year==1991, ]$Today, type='o')
plot(Weekly[Weekly$Year==1992, ]$Today, type='o')
plot(Weekly[Weekly$Year==1993, ]$Today, type='o')
plot(Weekly[Weekly$Year==1994, ]$Today, type='o')
View(Weekly)
source('script.R')
sums = sumtable(Weekly[Weekly$Year==1990]$Today)
sums = sumtable(Weekly[Weekly$Year==1990, ]$Today)
plot(sums, type='o')
plot(sumtable(Weekly[Weekly$Year==1991, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1992, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1993, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1994, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1995, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1996, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1997, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1998, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==1999, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2000, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2001, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2002, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2003, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2004, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2005, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2006, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2007, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2008, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2009, ]$Today), type='o')
plot(sumtable(Weekly[Weekly$Year==2010, ]$Today), type='o')
plot(sumtable(Weekly$Today), type='o')
plot( data.frame( Year=  Weekly$Year, stocks= sumtable(Weekly$Today), type='o'))
plot( data.frame( Year=  Weekly$Year, stocks= sumtable(Weekly$Today)))
plot( data.frame( Year=  Weekly$Year, stocks= sumtable(Weekly$Today)), type='o')
plot( data.frame( Year=  1:length(Weekly$Year) , stocks= sumtable(Weekly$Today)), type='o')
plot( data.frame( Year= (1:length(Weekly$Year))*20/1089 , stocks= sumtable(Weekly$Today)), type='o')
plot( data.frame( Year= (1:length(Weekly$Year))*20/1089 + 1990 , stocks= sumtable(Weekly$Today)), type='o')
plot( data.frame( Year= (1:length(Weekly$Year))*20/length(Weekly$Year) + 1990 , stocks= sumtable(Weekly$Today)), type='o')
View(Weekly)
plot(Weekly$Volume)
plot(Weekly$Volume, type='o')
install.packages('ppls')
normalize.vector(1:50)
require('ppls')
normalize.vector(1:50)
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), stocks= sumtable(Weekly$Today)), , type='o')
source('script.R')
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), stocks= sumtable(Weekly$Today)), , type='o')
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), stocks= sumtable(Weekly$Today)),type='o')
View(Weekly)
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), stocks= normalize(sumtable(Weekly$Today))), normalize(Weekly$Volume),type='o')
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), x= normalize(sumtable(Weekly$Today))), type='o')
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), x= normalize(sumtable(Weekly$Today))), type='l', col='blue')
lines(data.frame( Year= ( normalize(1:1089)*20 + 1990), x=normalize(Weekly$Volume)), col='red')
directions = Weekly$Direction=='Up'
directions
Weekly$Direction = directions
load('Weekly.rda')
View(Weekly)
View(Weekly)
Weekly$Up = directions
View(Weekly)
Weekly$Up[Weekly$Up]
Weekly$Up[Weekly$Up] = 1
Weekly$Up
View(Weekly)
e = exp(1)
View(Weekly)
model = lm(Up ~ exp(Lag1 + Lag2 + Lag3 + Lag4 + lag5), Weekly)
model = lm(Up ~ exp(Lag1 + Lag2 + Lag3 + Lag4 + Lag5), Weekly)
plot(fitted(model))
model = lm(Up ~ exp(Lag1 + Lag2 + Lag3 + Lag4 + Lag5) / 1 - exp(Lag1 + Lag2 + Lag3 + Lag4 + Lag5) , Weekly)
plot(fitted(model))
model = lm(Up ~ exp(Lag1) / 1 - exp(Lag1) , Weekly)
plot(fitted(model))
plot(fitted(model), type = 'o')
plot(fitted(model), type= 'o')
summary(model)
model = lm(Up ~ exp(Lag1 + Lag2 + Lag3 + Lag4 + Lag5) / 1 - exp(Lag1 + Lag2 + Lag3 + Lag4 + Lag5) , Weekly)
summary(model)
View(Weekly)
plot( data.frame( Year= ( normalize(1:1089)*20 + 1990), x= normalize(sumtable(Weekly$Lag1 + Weekly$Lag2 + Weekly$Lag3 + Weekly$Lag4 + Weekly$Lag5))), type='l', col='blue')
lines(data.frame( Year= ( normalize(1:1089)*20 + 1990), x=normalize(Weekly$Volume)), col='red')
Weekly['Up']
Weekly[-'Up']
Weekly['Up'] = NA
View(Weekly)
Weekly[-10]
View(Weekly)
Weekly[10]
Weekly[-10]
Weekly = Weekly[-10]
View(Weekly)
View(Weekly)
model = glm(formula= Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5, family = binomial, data=Weekly )
plot(fitted(model))
plot(data.frame(y = fitted(model)))
plot(data.frame(y = fitted(model), x = 1:1089 ))
plot(x = 1:1089, data.frame(y = fitted(model) ))
plot(x = 1:length(fitted(model)), data.frame(y = fitted(model) ))
plot(data.frame(x=1:1089 ,y = fitted(model) ))
fitted(model)
fitted(model)>0.5
(fitted(model)>0.5) == (Weekly$Direction == 'UP')
(fitted(model)>0.5) == (Weekly$Direction == 'Up')
(fitted(model)>0.5)
(fitted(model)
)
(fitted(model)>0.5) == (Weekly$Direction == 'Down')
sum((fitted(model)>0.5) == (Weekly$Direction == 'Down') )
sum((fitted(model)>0.5) == (Weekly$Direction == 'Up') )
summary(model)
coef(model)
model.probs = predict(model, type="response" )
model.probs[1:10]
contrasts(model)
contrasts("Up")
contrasts(Weekly$Direction)
models.pred = rep("Down", 1089)
model.pred = models.pred
rm models.pred
rm(models.pred)
model.pred[model.probs > 0.5] = 'Up'
table(model.pred, Weekly$Direction)
model.confusion = table(model.pred, Weekly$Direction)
model.confusion
(49 + 564)/1089
model2 = glm(formula = Direction ~ Lag2, family = polynomial, data = Weekly[Weekly$Year<=2008])
model2 = glm(formula = Direction ~ Lag2, family = binomial, data = Weekly[Weekly$Year<=2008])
model2 = glm(formula = Direction ~ Lag2, family = binomial, data = Weekly[Weekly$Year<=2008, ])
View(Weekly[Weekly$Year<=2008, ])
train = Weekly[Weekly$Year<=2008, ]
test = Weekly[Weekly$Year>2008, ]
model2.pred = predict(model2, newdata = test, type="response")
model2.probs = model2.pred
model2.pred = rep("Down", length(model2.probs))
model2.pred[model2.probs > 0.5] = "Up"
model2.pred
model2.confusion = table(model2.pred, test$Direction)
model2.confusion
sum(model2.confusion)
(56+9) /  sum(model2.confusion)
model2.accuracy = (56+9) /  sum(model2.confusion)
model2.accuracy
model3.fit = lda(Direction ~ Lag2, train)
mode3.pred = predict(model3.fit, test)
model3.pred
model3.pred = mode3.pred
rm(mode3.pred)
model3.pred
model3.class = model3.pred$class
model3.confusion = table(model3.class, test$Direction)
model3.confusion
model3.accuracy = (9 + 56) / sum(model3.confusion)
model3.accuracy
model4.fit = qda(Direction ~ Lag2, train)
model4.pred = predict(model4.fit, test)
model4.class = model4.pred$class
model4.confusion = table(model4.class, test$Direction)
model4.confusion
model4.accuracy = 61 / (61+43)
model4.accuracy
library(class)
train.X = cbind(Lag1, Lag2)[train, ]
train.X = cbind(train$Lag1, train$Lag2)[train, ]
install.packages("class")
install.packages("class")
library("class")
train.X = cbind(Lag1, Lag2)[train, ]
train.X = cbind(train$Lag1, train$Lag2)[train, ]
train.X = cbind(train$Lag1, train$Lag2)
train.X
test.X = cbind(test$Lag1, test$Lag2)
model5.pred = knn(train.X, test.X, train$Direction)
table(model5.pred, test$Direction)
model5.accuracy = (18+32)/sum(model5.pred)
model5.confusion = table(model5.pred, test$Direction)
model5.accuracy = (18+32)/sum(model5.confusion)
model5.accuracy
model5.pred = knn(train.X, test.X, train$Direction, k=1)
model5.confusion = table(model5.pred, test$Direction)
model5.accuracy = (18+32)/sum(model5.confusion)
model5.confusion
model5.accuracy = (18+32)/sum(model5.confusion)
